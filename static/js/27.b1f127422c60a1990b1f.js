webpackJsonp([27],{1046:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"system-menu"},[s("el-row",{staticClass:"height100"},[s("el-col",{staticClass:"left-side relative height100",attrs:{span:5}},[s("div",{staticClass:"system-menu-list"},[s("el-tree",{ref:"tree",attrs:{data:e.menu,"default-expand-all":"","node-key":"id","highlight-current":"","expand-on-click-node":!1,"current-node-key":e.currentId,props:e.defaultProps},on:{"node-click":e.viewMenu}})],1)]),e._v(" "),s("el-col",{staticClass:"system-menu-content",attrs:{span:19}},[s("div",{staticClass:"el-tabs__header"},[s("div",{staticClass:"el-tabs__nav-wrap"},[s("div",{staticClass:"el-tabs__nav-scroll"},[s("div",{staticClass:"el-tabs__nav"},e._l(e.tabs,function(t){return s("div",{staticClass:"el-tabs__item",class:{"is-active":e.activeIndex===t.index},on:{click:function(s){s.stopPropagation(),e.changeTab(t.index)}}},[e._v(e._s(t.label))])})),e._v(" "),e.permission.delete?s("div",{staticClass:"fr",staticStyle:{"margin-right":"20px","margin-top":"7px"}},[s("el-button",{attrs:{size:"small"},on:{click:function(t){t.stopPropagation(),e.confirmDelete(t)}}},[e._v("删除")])],1):e._e()])])]),e._v(" "),s("div",{staticStyle:{width:"90%"}},[s("el-row",{attrs:{gutter:16}},[s("el-col",{staticClass:"form-label text-right",attrs:{span:3}},[e._v("菜单名称")]),e._v(" "),s("el-col",{attrs:{span:5}},[s("el-input",{attrs:{placeholder:"必填项",readonly:e.isView},model:{value:e.model.name,callback:function(t){e.model.name="string"==typeof t?t.trim():t},expression:"model.name"}})],1),e._v(" "),s("el-col",{staticClass:"form-label text-right",attrs:{span:3}},[e._v("父级菜单")]),e._v(" "),s("el-col",{attrs:{span:5}},[s("el-input",{directives:[{name:"show",rawName:"v-show",value:e.isView,expression:"isView"}],attrs:{readonly:""},model:{value:e.parentMenuName,callback:function(t){e.parentMenuName=t},expression:"parentMenuName"}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isView,expression:"!isView"}]},[s("el-select",{staticClass:"dis-block",attrs:{disabled:1!==e.activeIndex},model:{value:e.model.parentId,callback:function(t){e.model.parentId=t},expression:"model.parentId"}},e._l(e.parentMenuOptions,function(t){return s("el-option",{key:t.id,attrs:{label:t.label,value:t.value}},[s("div",{staticStyle:{"margin-left":"-10px"},style:{"padding-left":t.left+"px"}},[s("span",{staticClass:"el-tree-node__expand-icon",class:t.children?"expanded":"is-leaf"}),e._v(" "),s("span",{staticClass:"el-tree-node__label"},[e._v(e._s(t.label))])])])}))],1)],1),e._v(" "),s("el-col",{staticClass:"form-label text-right",attrs:{span:3}},[e._v("优先级")]),e._v(" "),s("el-col",{attrs:{span:5}},[s("el-input",{attrs:{readonly:e.isView},model:{value:e.model.priority,callback:function(t){e.model.priority="string"==typeof t?t.trim():t},expression:"model.priority"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:16}},[s("el-col",{staticClass:"form-label text-right",attrs:{span:3}},[e._v("链接地址")]),e._v(" "),s("el-col",{attrs:{span:5}},[s("el-input",{attrs:{readonly:e.isView,placeholder:"必填项"},model:{value:e.model.url,callback:function(t){e.model.url="string"==typeof t?t.trim():t},expression:"model.url"}})],1),e._v(" "),s("el-col",{staticClass:"form-label text-right",attrs:{span:3}},[e._v("菜单标识")]),e._v(" "),s("el-col",{attrs:{span:5}},[s("el-input",{attrs:{readonly:e.isView},model:{value:e.model.sign,callback:function(t){e.model.sign="string"==typeof t?t.trim():t},expression:"model.sign"}})],1),e._v(" "),s("el-col",{staticClass:"form-label text-right",attrs:{span:3,readonly:e.isView}},[e._v("备注")]),e._v(" "),s("el-col",{attrs:{span:5}},[s("el-input",{attrs:{readonly:e.isView},model:{value:e.model.description,callback:function(t){e.model.description="string"==typeof t?t.trim():t},expression:"model.description"}})],1)],1),e._v(" "),s("el-row",{staticClass:"form-label",attrs:{gutter:16}},[s("el-col",{staticClass:"text-right",attrs:{span:3}},[e._v("资源权限")]),e._v(" "),s("el-col",{attrs:{span:21}},[e.isView?e._l(e.model.permissionVoList,function(t){return s("el-checkbox",{key:t.sign,attrs:{disabled:!0,checked:!0}},[e._v(e._s(t.name))])}):[s("el-checkbox-group",{model:{value:e.permissionVoList,callback:function(t){e.permissionVoList=t},expression:"permissionVoList"}},e._l(e.resource,function(t,i){return s("el-checkbox",{key:t.sign,attrs:{label:t.sign,disabled:"view"===t.sign}},[e._v(e._s(t.name))])}))]],2)],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:0!==e.activeIndex,expression:"activeIndex !== 0"}]},[s("el-col",{attrs:{span:3}},[e._v(" ")]),e._v(" "),s("el-col",{attrs:{span:21}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){t.stopPropagation(),e.saveMenu(t)}}},[e._v("保存")])],1)],1)],1)])],1)],1)},n=[],a={render:i,staticRenderFns:n};t.a=a},232:function(e,t,s){"use strict";function i(e){s(952)}Object.defineProperty(t,"__esModule",{value:!0});var n=s(858),a=s.n(n),l=s(1046),r=s(23),o=i,d=r(a.a,l.a,o,"data-v-9ce994fa",null);t.default=d.exports},858:function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=s(!function(){var e=new Error('Cannot find module "babel-runtime/core-js/promise"');throw e.code="MODULE_NOT_FOUND",e}()),a=i(n),l=s(24),r=i(l),o=s(877),d=i(o),u=s(11),c=i(u);t.default={data:function(){return{menu:[],defaultProps:{children:"children",label:"name"},currentId:"",resource:d.default,model:{id:"",name:"",sign:"",description:"",priority:0,url:"",parentId:"",permissionVoList:[d.default[0]]},permissionVoList:[],tabs:[],parentMenuOptions:"",activeIndex:0}},computed:{isView:function(){return 0===this.activeIndex},parentMenuName:function(){var e="";return this.parentMenuOptions&&this.parentMenuOptions.length&&this.model.parentId&&(e=c.default.utils.findDataByValue(this.parentMenuOptions,this.model.parentId,"value"),e=e?e.label:""),e}},methods:{saveMenu:function(){var e=this;if(this.validate()){var t=void 0;return this.model.permissionVoList=this.getVoList(),t=this.model.id?{url:"admin/module/"+e.currentId,method:"put",data:this.model}:{url:"admin/module",method:"post",data:e.model},new a.default(function(s,i){(0,r.default)(t).then(function(t){t.result&&(e.getMenu(),e.assistModel=c.default.utils.assign({},e.model),1!==e.activeIndex&&e.resetModel()),e.getMessage(t.msg,t.result)})})}},getMenu:function(){var e=this;return new a.default(function(t,s){(0,r.default)({url:"admin/module/tree",method:"get"}).then(function(t){t.result&&t.data&&(e.menu=[t.data],e.$store.commit("SET_PERMISSION_MENU",[t.data]),e.setParentMenu(),e.currentId||e.viewMenu(t.data))})})},setParentMenu:function(){var e=[],t=this.menu&&this.menu.length||0,s=void 0;for(s=0;s<t;s++)this.fillParentMenu(e,this.menu[s],0);this.parentMenuOptions=e},fillParentMenu:function(e,t,s){var i=this;t&&(e.push({label:t.name,value:t.id,left:16*s,children:t.children&&t.children.length}),s++,t.children&&t.children.forEach(function(t,n){t.children&&t.children.length?i.fillParentMenu(e,t,s):e.push({label:t.name,value:t.id,left:16*s,children:0})}))},parseVoList:function(e){var t=[];return e&&e.forEach(function(e){t.push(e.sign)}),t},getVoList:function(){var e=this,t=[];return this.permissionVoList&&this.permissionVoList.forEach(function(s){var i=c.default.utils.findDataByValue(e.resource,s,"sign");i&&t.push(i)}),t},changeTab:function(e){this.activeIndex=e,2===e||3===e?(this.resetModel(),this.assistModel&&(2===e?this.assistModel.parentId&&(this.model.parentId=this.assistModel.parentId):this.model.parentId=this.assistModel.id)):this.assistModel&&this.setModel(this.assistModel)},viewMenu:function(e){this.currentId=e.id,this.setModel(e)},resetModel:function(){var e=void 0;for(e in this.model)switch(e){case"priority":this.model[e]=0;break;case"permissionVoList":this.model[e]=["view"];break;default:this.model[e]=""}this.permissionVoList=["view"]},setModel:function(e){var t=void 0;if(e.permissionVoList&&c.default.utils.isArray(e.permissionVoList)&&(this.permissionVoList=this.parseVoList(e.permissionVoList)),this.assistModel=c.default.utils.assign({},e),0===this.activeIndex||1===this.activeIndex)for(t in this.model)this.model[t]=e[t];else 2===this.activeIndex?this.assistModel&&this.assistModel.parentId?this.model.parentId=this.assistModel.parentId:this.model.parentId="":this.model.parentId=this.assistModel&&this.assistModel.id||""},validate:function(){return this.model.name?this.model.url?!!this.permissionVoList.length||(this.$message.error("请选择资源权限"),!1):(this.$message.error("请输入菜单链接地址"),!1):(this.$message.error("请输入菜单名称"),!1)},deleteMenu:function(){var e=this;return new a.default(function(t,s){(0,r.default)({url:"admin/module/"+e.currentId,method:"delete",data:""}).then(function(t){t.result&&(e.getMenu(),e.resetModel(),e.assistModel=null,e.currentId=""),e.getMessage(t.msg,t.result)})})},setTabs:function(){this.tabs=[{label:"查看",index:0,show:this.permission.view},{label:"修改",index:1,show:this.permission.edit},{label:"新增同级",index:2,show:this.permission.add},{label:"新增下级",index:3,show:this.permission.add}]},confirmDelete:function(){var e=this;if(""===this.currentId)return void this.$message.warning("请先选择一个菜单再进行删除操作");this.$confirm("确定要删除该菜单？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteMenu()}).catch(function(){})}},created:function(){this.setTabs(),this.$store.state.permission.permission_menu&&this.$store.state.permission.permission_menu.length?(this.menu=[].concat(this.$store.state.permission.permission_menu),this.setParentMenu(),this.currentId||this.viewMenu(this.menu[0])):this.getMenu()}}},877:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{name:"浏览",sign:"view"},{name:"新增",sign:"add"},{name:"修改",sign:"edit"},{name:"删除",sign:"delete"},{name:"导入",sign:"import"},{name:"导出",sign:"export"},{name:"上传",sign:"upload"},{name:"下载",sign:"download"},{name:"审核",sign:"verify"},{name:"分配",sign:"distribute"},{name:"解冻",sign:"unblocked"},{name:"取消",sign:"cancel"},{name:"全部取消",sign:"cancelAll"},{name:"启用",sign:"enable"},{name:"禁用",sign:"disable"},{name:"测试钱包",sign:"testWallet"},{name:"启/禁用",sign:"management"},{name:"回复",sign:"reply"},{name:"发币",sign:"sendCoin"},{name:"是否设置交易密码",sign:"setPassword"}]},912:function(e,t,s){t=e.exports=s(152)(!0),t.push([e.i,".parent-menu-items[data-v-9ce994fa]{min-width:196px;max-height:200px;overflow:auto}.parent-menu-items .el-tree[data-v-9ce994fa]{border:none}","",{version:3,sources:["C:/Users/XY-5-16-02/Desktop/dctp-admin-code/src/views/system/menu.vue"],names:[],mappings:"AACA,oCACE,gBAAiB,AACjB,iBAAkB,AAClB,aAAe,CAChB,AACD,6CACI,WAAa,CAChB",file:"menu.vue",sourcesContent:["\n.parent-menu-items[data-v-9ce994fa] {\n  min-width: 196px;\n  max-height: 200px;\n  overflow: auto;\n}\n.parent-menu-items .el-tree[data-v-9ce994fa] {\n    border: none;\n}\n"],sourceRoot:""}])},952:function(e,t,s){var i=s(912);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);s(153)("6d8ed770",i,!0)}});
//# sourceMappingURL=27.b1f127422c60a1990b1f.js.map