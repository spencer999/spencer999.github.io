webpackJsonp([81],{1029:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"system-menu"},[s("el-row",{staticClass:"height100"},[s("el-col",{staticClass:"left-side relative height100",attrs:{span:5}},[s("div",{staticClass:"system-menu-list"},[s("el-tree",{ref:"tree",attrs:{data:e.tableData,"default-expand-all":"","node-key":"id","highlight-current":"","expand-on-click-node":!1,"current-node-key":e.currentId,props:e.defaultProps},on:{"node-click":e.view}})],1)]),e._v(" "),s("el-col",{staticClass:"system-menu-content pb-10",attrs:{span:19}},[s("div",{staticClass:"el-tabs__header"},[s("div",{staticClass:"el-tabs__nav-wrap"},[s("div",{staticClass:"el-tabs__nav-scroll"},[s("div",{staticClass:"el-tabs__nav"},e._l(e.tabs,function(t){return s("div",{staticClass:"el-tabs__item",class:{"is-active":e.activeIndex===t.index},on:{click:function(s){s.stopPropagation(),e.changeTab(t.index)}}},[e._v(e._s(t.label))])})),e._v(" "),s("div",{staticClass:"fr",staticStyle:{"margin-right":"20px","margin-top":"7px"}},[s("el-button",{attrs:{size:"small"},on:{click:function(t){t.stopPropagation(),e.confirmDelete(t)}}},[e._v("删除")])],1)])])]),e._v(" "),s("div",[s("el-row",{attrs:{gutter:16}},[s("el-col",{staticClass:"form-label text-right",attrs:{span:3}},[e._v("角色名称")]),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-input",{model:{value:e.model.name,callback:function(t){e.model.name="string"==typeof t?t.trim():t},expression:"model.name"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:16}},[s("el-col",{staticClass:"form-label text-right",attrs:{span:3}},[e._v("角色描述")]),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-input",{attrs:{type:"textarea",resize:"none",autosize:!0},model:{value:e.model.description,callback:function(t){e.model.description="string"==typeof t?t.trim():t},expression:"model.description"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:16}},[s("el-col",{staticClass:"text-right",attrs:{span:3}},[e._v("角色权限")]),e._v(" "),s("el-col",{attrs:{span:21}},[s("el-checkbox-group",{model:{value:e.rolePermissionVoList,callback:function(t){e.rolePermissionVoList=t},expression:"rolePermissionVoList"}},e._l(e.permissionOptions,function(t){return s("el-row",{key:t.id,attrs:{gutter:16}},[s("el-col",{attrs:{span:7}},[s("div",{style:{"padding-left":t.left+"px"}},[s("span",{staticClass:"el-tree-node__expand-icon",class:t.children?"expanded":"is-leaf"}),e._v(" "),s("span",{staticClass:"el-tree-node__label"},[e._v(e._s(t.label))])])]),e._v(" "),s("el-col",{attrs:{span:17}},e._l(t.permissionVoList,function(t){return s("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])}))],1)}))],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:3}},[e._v(" ")]),e._v(" "),s("el-col",{attrs:{span:21}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){t.stopPropagation(),e.saveRole(t)}}},[e._v("保存")])],1)],1)],1)])],1)],1)},n=[],o={render:i,staticRenderFns:n};t.a=o},235:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(861),n=s.n(i),o=s(1029),l=s(23),r=l(n.a,o.a,null,null,null);t.default=r.exports},861:function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=s(!function(){var e=new Error('Cannot find module "babel-runtime/core-js/promise"');throw e.code="MODULE_NOT_FOUND",e}()),o=i(n),l=s(24),r=i(l),a=s(11),d=i(a);t.default={data:function(){return{tableData:[],defaultProps:{children:"children",label:"name"},tabs:[],currentId:"",activeIndex:1,model:{description:"",id:"",name:"",rolePermissionVoList:""},rolePermissionVoList:[],checkboxOptions:{}}},computed:{permissionOptions:function(){var e=[],t=this.$store.state.permission.permission_menu;t=t.length&&t[0].children?t[0].children:[];var s=t.length,i=void 0;for(i=0;i<s;i++)this.fillPermission(e,t[i],0);return e}},methods:{getRoles:function(){var e=this;return new o.default(function(t,s){(0,r.default)({url:"admin/roles",method:"get",params:{pageNum:1,pageSize:1e3}}).then(function(t){t.result&&(e.tableData=t.data.data)})})},saveRole:function(){var e=this;if(this.validate()){var t=void 0;return this.model.rolePermissionVoList=this.getRolePermissionVoList(),t=this.model.id?{url:"admin/role/"+e.currentId,method:"put",data:this.model}:{url:"admin/role",method:"post",data:e.model},new o.default(function(s,i){(0,r.default)(t).then(function(t){t.result&&(e.getRoles(),e.assistModel=d.default.utils.assign({},e.model),1===e.activeIndex&&e.resetModel()),e.getMessage(t.msg,t.result)})})}},deleteRole:function(){var e=this;return new o.default(function(t,s){(0,r.default)({url:"admin/role/"+e.currentId,method:"delete"}).then(function(t){t.result&&(e.getRoles(),e.resetModel(),e.assistModel=null,e.currentId=""),e.getMessage(t.msg,t.result)})})},confirmDelete:function(){var e=this;if(""===this.currentId)return void this.$message.warning("请先选择一个角色再进行删除操作");this.$confirm("确定要删除该角色吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteRole()}).catch(function(){})},changeTab:function(e){if(0===e&&!this.currentId)return void this.$message.warning("请先选择一个角色");this.activeIndex=e,1===e?this.resetModel():this.assistModel&&this.setModel(this.assistModel)},view:function(e){var t=this;return this.currentId=e.id,this.changeTab(0),new o.default(function(e,s){(0,r.default)({url:"admin/role/"+t.currentId,method:"get"}).then(function(e){e.result?t.setModel(e.data):t.getMessage(e.msg,e.result)})})},resetModel:function(){var e=void 0;for(e in this.model)this.model[e]="";this.rolePermissionVoList=[]},setModel:function(e){var t=void 0;if(this.assistModel=d.default.utils.assign({},e),0===this.activeIndex){for(t in this.model)this.model[t]=e[t];this.setRolePermissionVoList()}},setTabs:function(){this.tabs=[{label:"修改",index:0,show:this.permission.edit},{label:"新增",index:1,show:this.permission.add}]},fillPermission:function(e,t,s){var i=this;t&&(e.push({label:t.name,value:t.id,left:16*s,children:t.children&&t.children.length,permissionVoList:t.permissionVoList}),s++,t.children&&t.children.forEach(function(t,n){t.children&&t.children.length?i.fillPermission(e,t,s):e.push({label:t.name,value:t.id,left:16*s,children:0,permissionVoList:t.permissionVoList})}))},getRolePermissionVoList:function(){var e=[];return this.rolePermissionVoList&&this.rolePermissionVoList.forEach(function(t){e.push({permissionId:t})}),e},setRolePermissionVoList:function(){var e=[];this.model.rolePermissionVoList&&this.model.rolePermissionVoList.forEach(function(t){e.push(t.permissionId)}),this.rolePermissionVoList=e},validate:function(){return this.model.name?!!this.rolePermissionVoList.length||(this.$message.error("请选择角色权限"),!1):(this.$message.error("请输入角色名称"),!1)}},created:function(){this.setTabs(),this.getRoles()}}}});
//# sourceMappingURL=81.ad8298d4027eda849c1a.js.map